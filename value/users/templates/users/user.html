{% extends 'base.html' %}

{% block breadcrumb %}
  <ol class="breadcrumb">
    <li><a href="{% url 'home' %}">Home</a></li>
    <li><a href="{% url 'users:users' %}">Users</a></li>
    <li class="active">{{ form.instance.username }}</li>
  </ol>
{% endblock breadcrumb %}

{% block main %}
  <h1 class="lead">Change user</h1>

  {% if form.non_field_errors %}
    <div class="alert alert-danger alert-dismissible" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      {% for error in form.non_field_errors %}
        {{ error }}
      {% endfor %}
    </div>
  {% endif %}

  <form method="post" class="form-horizontal">

    {% csrf_token %}

    <div class="form-group{% if form.username.errors %} has-error{% endif %}">
      <label for="{{ form.username.id_for_label }}" class="col-sm-2 control-label">{{ form.username.label }}</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" value="{{ form.username.value }}" id="{{ form.username.id_for_label }}" name="{{ form.username.html_name }}" maxlength="{{ form.username.field.max_length }}">
        {% for error in form.username.errors %}
          <p class="help-block">{{ error }}</p>
        {% endfor %}
        <span class="help-block">{{ form.username.help_text }}</span>
      </div>
    </div>

    <div class="form-group">
      <label for="{{ form.password.id_for_label }}" class="col-sm-2 control-label">{{ form.password.label }}</label>
      <div class="col-sm-10">
        {{ form.password }}
        <input type="hidden" name="password" value="123">
        <span class="help-block">{{ form.password.help_text | safe }}</span>
      </div>
    </div>

    <hr>

    <div class="form-group{% if form.first_name.errors %} has-error{% endif %}">
      <label for="{{ form.first_name.id_for_label }}" class="col-sm-2 control-label">{{ form.first_name.label }}</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" value="{{ form.first_name.value }}" id="{{ form.first_name.id_for_label }}" name="{{ form.first_name.html_name }}" maxlength="{{ form.first_name.field.max_length }}">
      </div>
    </div>

    <div class="form-group{% if form.last_name.errors %} has-error{% endif %}">
      <label for="{{ form.last_name.id_for_label }}" class="col-sm-2 control-label">{{ form.last_name.label }}</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" value="{{ form.last_name.value }}" id="{{ form.last_name.id_for_label }}" name="{{ form.last_name.html_name }}" maxlength="{{ form.last_name.field.max_length }}">
      </div>
    </div>

    <div class="form-group{% if form.email.errors %} has-error{% endif %}">
      <label for="{{ form.email.id_for_label }}" class="col-sm-2 control-label">{{ form.email.label }}</label>
      <div class="col-sm-10">
        <input type="email" class="form-control" value="{{ form.email.value }}" id="{{ form.email.id_for_label }}" name="{{ form.email.html_name }}" maxlength="{{ form.email.field.max_length }}">
      </div>
    </div>

    <hr>

    <div class="form-group">
      <div class="col-sm-10 col-sm-offset-2">
        <div class="checkbox">
          <label>
            {{ form.is_active }} {{ form.is_active.label }}
          </label>
        </div>
        <span class="help-block">{{ form.is_active.help_text }}</span>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-10 col-sm-offset-2">
        <div class="checkbox">
          <label>
            {{ form.is_superuser }} {{ form.is_superuser.label }}
          </label>
        </div>
        <span class="help-block">{{ form.is_superuser.help_text }}</span>
      </div>
    </div>

    <hr>

    <div class="form-group">
      <label class="col-sm-2 control-label">Value Factors</label>
      <div class="col-sm-10">
        <div class="row">
          {% for factor in factors %}
            <div class="col-sm-3">
              <div class="checkbox">
                <label>
                  <input type="checkbox" id="id_factor" name="id_factor" value="{{ factor.id }}"> {{ factor.name }} 
                  {% if factor.description %}
                    <a href="javascript:void(0);" tabindex="0" data-toggle="popover" data-trigger="focus" title="Description" data-content="{{ factor.description }}" data-container="body"><span class="glyphicon glyphicon-question-sign"></span></a>
                  {% endif %}
                </label>
              </div>
            </div>
            {% if forloop.counter|divisibleby:4 %}</div><div class="row">{% endif %}
          {% endfor %}
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10">
        <a href="{% url 'users:delete' form.instance.pk %}" class="btn btn-danger pull-right">Delete</a>
        <button type="submit" class="btn btn-primary">Save</button>
        <a href="{% url 'users:users' %}" class="btn btn-default">Cancel</a>
      </div>
    </div>

  </form>

{% endblock main %}
